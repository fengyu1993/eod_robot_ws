<?xml version="1.0" encoding="utf-8"?>

<robot name="eod_robot_description_vehicle" xmlns:xacro="http://www.ros.org/wiki/xacro">

<xacro:property name="m" value="10"/>
<xacro:property name="d" value="0.3"/>
<xacro:property name="w" value="0.2"/>
<xacro:property name="h" value="0.1"/>

<xacro:macro name="vehicle">

    <link name="right_front_wheel">  
        <visual>  
            <geometry>  
                <cylinder length="0.06" radius="0.098"/>  
            </geometry>  
            <origin xyz="0 0.03 0" rpy="1.5708 0 0" />
            <material name="">  
                <color rgba="0 0.5 0.8  0"/>  
            </material>  
        </visual>  
        <inertial>
            <mass value="${m}" />
            <inertia ixx="${1/12*m*(w*w + h*h)}" ixy= "0" ixz= "0"
                iyy="${1/12*m*(d*d + h*h)}"  iyz= "0"
                izz="${1/12*m*(d*d + w*w)}"  /> 
        </inertial>   
        <collision>
          <origin xyz="0 -0.03 0" rpy="1.5708 0 0" />
          <geometry>
            <cylinder length="0.06" radius="0.098"/>
          </geometry>
        </collision>  
    </link>  
    
    <joint name="right_front_wheel_joint" type="continuous">  
        <axis xyz="0 1 0"/>  
        <parent link="base_link"/>  
        <child link="right_front_wheel"/>  
        <origin rpy="0 0 0" xyz="-0.062 -0.2765 -0.402"/> 
        <limit effort="100" velocity="100"/>  
        <joint_properties damping="0.0" friction="0.0"/>  
    </joint>  
    
    <link name="right_back_wheel">  
      <visual>  
          <geometry>  
            <cylinder length="0.06" radius="0.098"/>  
          </geometry>  
          <origin xyz="0 0.03 0" rpy="1.5708 0 0" />
          <material name="">  
            <color rgba="0 0.5 0.8 0"/>  
          </material>  
      </visual>  
        <inertial>
            <mass value="2" />
            <inertia ixx="0.005402" ixy= "0" ixz= "0"
                iyy="0.009604" iyz= "0"
                izz="0.005402" /> 
        </inertial>  
        <collision>
          <origin xyz="0 -0.03 0" rpy="1.5708 0 0" />
          <geometry>
            <cylinder length="0.06" radius="0.098"/>
          </geometry>
        </collision>   
    </link>  
    
    <joint name="right_back_wheel_joint" type="continuous">  
        <axis xyz="0 1 0"/>  
        <parent link="base_link"/>  
        <child link="right_back_wheel"/>  
        <origin rpy="0 0 0" xyz="-0.602 -0.276 -0.402"/>  
        <limit effort="100" velocity="100"/>  
        <joint_properties damping="0.0" friction="0.0"/>  
    </joint>  
    
    <link name="left_front_wheel">  
        <visual>  
            <geometry>  
                <cylinder length="0.06" radius="0.098"/>  
            </geometry>  
            <origin xyz="0 -0.03 0" rpy="1.5708 0 0" />
            <material name="">  
                <color rgba="0 0.5 0.8 0"/>  
            </material>  
        </visual>  
        <inertial>
            <mass value="2" />
            <inertia ixx="0.005402" ixy= "0" ixz= "0"
                iyy="0.009604" iyz= "0"
                izz="0.005402" /> 
        </inertial>   
        <collision>
          <origin xyz="0 -0.03 0" rpy="1.5708 0 0" />
          <geometry>
            <cylinder length="0.06" radius="0.098"/>
          </geometry>
        </collision>  
    </link>  
    
    <joint name="left_front_wheel_joint" type="continuous">  
        <axis xyz="0 1 0"/>  
        <parent link="base_link"/>  
        <child link="left_front_wheel"/>  
        <origin rpy="0 0 0" xyz="-0.062 0.2765 -0.402"/>  
        <limit effort="100" velocity="100"/>  
        <joint_properties damping="0.0" friction="0.0"/>  
    </joint>  
    
    <link name="left_back_wheel">  
        <visual>  
            <geometry>  
                <cylinder length="0.06" radius="0.098"/>  
            </geometry>  
            <origin xyz="0 -0.03 0" rpy="1.5708 0 0" />
            <material name="">  
                <color rgba="0 0.5 0.8 0"/>  
            </material>  
        </visual> 
        <inertial>
            <mass value="2" />
            <inertia ixx="0.005402" ixy= "0" ixz= "0"
                iyy="0.009604" iyz= "0"
                izz="0.005402" /> 
        </inertial>  
        <collision>
          <origin xyz="0 -0.03 0" rpy="1.5708 0 0" />
          <geometry>
            <cylinder length="0.06" radius="0.098"/>
          </geometry>
        </collision>       
    </link>  
    
    <joint name="left_back_wheel_joint" type="continuous">  
        <axis xyz="0 1 0"/>  
        <parent link="base_link"/>  
        <child link="left_back_wheel"/>  
        <origin rpy="0 0 0" xyz="-0.602 0.2765 -0.402"/>  
        <limit effort="100" velocity="100"/>  
        <joint_properties damping="0.0" friction="0.0"/>  
    </joint>  

  <link
    name="base_link">
    <inertial>
      <origin xyz="-0.17885 0.0017998 -0.1738" rpy="0 0 0" />
      <mass value="107.28" />
      <inertia ixx="1.52" ixy="0.001111" ixz="0.079409" iyy="2.3271" iyz="-0.00027816" izz="3.0127" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://eod_robot_description/meshes/base_link.STL" />
      </geometry>
      <material name="">
        <color rgba="0.0078 0.4686 0.2294 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://eod_robot_description/meshes/base_link.STL" />
      </geometry>
    </collision>
  </link>    

    
    <link name="counter_weight_link">  
        <visual>  
            <geometry>  
                <box size="0.3 0.2 0.1"/> 
            </geometry>  
            <origin xyz="0 0 0" rpy="0 0 0" />
            <material name="">  
                <color rgba="0 0.5 0.8 0"/>  
            </material>  
        </visual> 
        <inertial>
            <mass value="2" />
            <inertia ixx="0.005402" ixy= "0" ixz= "0"
                iyy="0.009604" iyz= "0"
                izz="0.005402" /> 
        </inertial>  
        <collision>
          <origin xyz="0 0 0" rpy="0 0 0" />
          <geometry>
            <box size="0.3 0.2 0.1"/> 
          </geometry>
        </collision>       
    </link>  

    <joint name="counter_weight_joint" type="fixed">  
        <axis xyz="0 1 0"/>  
        <parent link="base_link"/>  
        <child link="counter_weight_link"/>  
        <origin rpy="0 0 0" xyz="-0.602 0 -0.35"/>  
    </joint> 

 
    <transmission name="left_front_wheel_joint_trans">
        <type>transmission_interface/SimpleTransmission</type>
        <joint name="left_front_wheel_joint" >
            <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
        </joint>
        <actuator name="left_front_wheel_joint_motor">
            <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
            <mechanicalReduction>1</mechanicalReduction>
        </actuator>
    </transmission>

    <transmission name="right_front_wheel_joint_trans">
        <type>transmission_interface/SimpleTransmission</type>
        <joint name="right_front_wheel_joint" >
            <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
        </joint>
        <actuator name="right_front_wheel_joint_motor">
            <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
            <mechanicalReduction>1</mechanicalReduction>
        </actuator>
    </transmission>

    <transmission name="right_back_wheel_joint_trans">
        <type>transmission_interface/SimpleTransmission</type>
        <joint name="right_back_wheel_joint" >
            <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
        </joint>
        <actuator name="right_back_wheel_joint_motor">
            <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
            <mechanicalReduction>1</mechanicalReduction>
        </actuator>
    </transmission>

    <transmission name="left_back_wheel_joint_trans">
        <type>transmission_interface/SimpleTransmission</type>
        <joint name="left_back_wheel_joint" >
            <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
        </joint>
        <actuator name="left_back_wheel_joint_motor">
            <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
            <mechanicalReduction>1</mechanicalReduction>
        </actuator>
    </transmission>
 
<!--<gazebo>
  <plugin name="skid_steer_drive_controller" filename="libgazebo_ros_skid_steer_drive.so">
    <updateRate>50.0</updateRate>
    <robotNamespace>/</robotNamespace>
    <leftFrontJoint>left_front_wheel_joint</leftFrontJoint>
    <leftRearJoint>left_back_wheel_joint</leftRearJoint>
    <rightFrontJoint>right_front_wheel_joint</rightFrontJoint>
    <rightRearJoint>right_back_wheel_joint</rightRearJoint>
    <wheelSeparation>4</wheelSeparation>
    <wheelDiameter>0.196</wheelDiameter>
    <commandTopic>cmd_vel</commandTopic>
    <odometryTopic>odom</odometryTopic>
    <robotBaseFrame>base_link</robotBaseFrame>
    <odometryFrame>odom</odometryFrame>
    <torque>80</torque>
    <topicName>cmd_vel</topicName>
    <broadcastTF>1</broadcastTF>
  </plugin>
</gazebo>  -->

  <gazebo reference="right_front_wheel">
    <mu1>10000000</mu1>
    <mu2>10000000</mu2>
    <kp>10000000</kp>
    <kd>1</kd>  
    <minDepth>0.01</minDepth>
    <maxVel>100</maxVel>   
    <material>Gazebo/GreenTransparent</material>       
  </gazebo>

  <gazebo reference="right_back_wheel">
    <mu1>10000000</mu1>
    <mu2>10000000</mu2>
    <kp>10000000</kp>
    <kd>1</kd>  
    <minDepth>0.01</minDepth>
    <maxVel>100</maxVel>    
    <material>Gazebo/GreenTransparent</material>      
  </gazebo>

  <gazebo reference="left_front_wheel">
    <mu1>10000000</mu1>
    <mu2>10000000</mu2>
    <kp>10000000</kp>
    <kd>1</kd>  
    <minDepth>0.01</minDepth>
    <maxVel>100</maxVel>  
    <material>Gazebo/GreenTransparent</material>        
  </gazebo>

  <gazebo reference="left_back_wheel">
    <mu1>10000000</mu1>
    <mu2>10000000</mu2>
    <kp>10000000</kp>
    <kd>1</kd>  
    <minDepth>0.01</minDepth>
    <maxVel>100</maxVel>          
    <material>Gazebo/GreenTransparent</material>
  </gazebo>

<gazebo reference="base_link">
    <implicitSpringDamper>1</implicitSpringDamper>
    <mu1>100000</mu1>
    <mu2>100000</mu2>
    <kp>100000000.0</kp>
    <kd>1.0</kd>
    <material>Gazebo/Green</material>
  </gazebo>

<gazebo reference="counter_weight_link">
    <implicitSpringDamper>1</implicitSpringDamper>
    <mu1>100000</mu1>
    <mu2>100000</mu2>
    <kp>100000000.0</kp>
    <kd>1.0</kd>
    <material>Gazebo/GreenTransparent</material>
  </gazebo>

</xacro:macro>

</robot>
